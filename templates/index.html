<!DOCTYPE html>
<html lang="pt-br">
<head>
    <title>Criador de currículo</title>
    <meta charset=" UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Bootstrap CDN -->
    <link rel="stylesheet" href="../static/css/bootstrap.min.css"/>
    <!-- Font Awesome CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"/>
</head>

<!-- Navbar-->
<body class="overflow-hidden">
<div class="container">
    <section class="container" style="padding-top: 72px;">
        <nav class="navbar fixed-top navbar-expand-lg bg-primary" data-bs-theme="dark">
            <div class="container-fluid">
                <a class="navbar-brand" href="/"> CV Builder </a>
                <button
                        class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarColor01"
                        aria-controls="navbarColor01" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <div class="navbar-collapse collapse" id="navbarColor01">
                    <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
                        {% if not usuario %}
                            <li class="nav-item">
                                <a class="nav-link btn" data-bs-toggle="modal" data-bs-target="#loginModal"><i
                                        class="fa-solid fa-right-to-bracket"></i> Login</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link btn" data-bs-toggle="modal" data-bs-target="#registerModal"><i
                                        class="fa-solid fa-address-card"></i> Registrar</a>
                            </li>
                        {% elif usuario %}
                            <li class="nav-item">
                                <a class="nav-link" href="/logout">Logout</a>
                            </li>
                        {% endif %}
                    </ul>
                </div>
            </div>
        </nav>
    </section>
    <!-- Navbar-->


    <!-- Conteúdo -->
    {% if usuario %}
        <section class="container">
            <div class="row">
                <!-- Lado esquerdo -->
                <div class="col col-6" style="height: 100vh; overflow-y: auto;">

                    <form action="/customizacao" method="post">
                        <div class="mt-1">
                            <h4> Customização </h4>


                            <div class="mt-3">
                                <label>Cores : </label>
                                <div class="row m-auto">
                                    <div class="btn btn-lg col col-1" type="submit" name="color" style="background-color: rgb(239, 68, 68);" tabindex="0"
                                         value="ef4444"></div>
                                    <div class="btn btn-lg col col-1" type="submit" name="color" style="background-color: rgb(248, 113, 113);" tabindex="0"
                                         value="f87171"></div>
                                    <div class="btn btn-lg col col-1" type="submit" name="color" style="background-color: rgb(251, 146, 60);" tabindex="0"
                                         value="fbb23c"></div>
                                    <div class="btn btn-lg col col-1" type="submit" name="color" style="background-color: rgb(249, 115, 22);" tabindex="0"
                                         value="f97316"></div>
                                    <div class="btn btn-lg col col-1" type="submit" name="color" style="background-color: rgb(245, 158, 11);" tabindex="0"
                                         value="f59e0b"></div>
                                    <div class="btn btn-lg col col-1" type="submit" name="color" style="background-color: rgb(251, 191, 36);" tabindex="0"
                                         value="fbbf24"></div>
                                    <div class="btn btn-lg col col-1" type="submit" name="color" style="background-color: rgb(34, 197, 94);" tabindex="0"
                                         value="22c55e"></div>
                                    <div class="btn btn-lg col col-1" type="submit" name="color" style="background-color: rgb(21, 128, 61);" tabindex="0"
                                         value="15803d"></div>
                                    <div class="btn btn-lg col col-1" type="submit" name="color" style="background-color: rgb(56, 189, 248);" tabindex="0"
                                         value="38bdf8"></div>
                                    <div class="btn btn-lg col col-1" type="submit" name="color" style="background-color: rgb(14, 165, 233);" tabindex="0"
                                         value="0ea5e9"></div>
                                    <div class="btn btn-lg col col-1" type="submit" name="color" style="background-color: rgb(129, 140, 248);" tabindex="0"
                                         value="818cf8"></div>
                                    <div class="btn btn-lg col col-1" type="submit" name="color" style="background-color: rgb(99, 102, 241);" tabindex="0"
                                         value="6366f1"></div>
                                </div>
                            </div>

                            <div class="mt-3">
                                <label>Fontes :</label>
                                <div class="row row-cols-3">
                                    <div class="btn col" type="submit" name="font" value="Arial, sans-serif" style="font-family: 'Arial', sans-serif;" tabindex="0">
                                        Arial
                                    </div>
                                    <div class="btn col" type="submit" name="font" value="Verdana, sans-serif" style="font-family: 'Verdana', sans-serif;"
                                         tabindex="0">
                                        Verdana
                                    </div>
                                    <div class="btn col" type="submit" name="font" value="Tahoma, sans-serif" style="font-family: 'Tahoma', sans-serif;"
                                         tabindex="0">
                                        Tahoma
                                    </div>
                                    <div class="btn col" type="submit" name="font" value="Trebuchet MS, sans-serif" style="font-family: 'Trebuchet MS', sans-serif;"
                                         tabindex="0">Trebuchet MS
                                    </div>
                                    <div class="btn col" type="submit" name="font" value="Georgia, serif" style="font-family: 'Georgia', serif;" tabindex="0">Georgia
                                    </div>
                                    <div class="btn col" type="submit" name="font" value="Times New Roman, serif" style="font-family: 'Times New Roman', serif;"
                                         tabindex="0">Times New Roman
                                    </div>
                                    <div class="btn col" type="submit" name="font" value="Courier New, monospace" style="font-family: 'Courier New', monospace;"
                                         tabindex="0">Courier New
                                    </div>
                                    <div class="btn col" type="submit" name="font" value="Lucida Console, monospace"
                                         style="font-family: 'Lucida Console', monospace;"
                                         tabindex="0">Lucida Console
                                    </div>
                                    <div class="btn col" type="submit" name="font" value="Brush Script MT', cursive" style="font-family: 'Brush Script MT', cursive;">Brush Script MT
                                    </div>
                                </div>
                            </div>


                            <div class="mt-3">
                                <label> Tamanho da fonte :</label>
                                <div class="row m-auto justify-content-around ">
                                    <button type="submit" name="size" value="12" class="btn btn-lg col" style="font-size: 12px;">Pequeno</button>
                                    <button type="submit" name="size" value="16" class="btn btn-lg col" style="font-size: 16px;">Médio</button>
                                    <button type="submit" name="size" value="20" class="btn btn-lg col" style="font-size: 20px;">Grande</button>
                                </div>
                            </div>
                    </form>
                </div>

                <!-- Dados pessoais -->
                <div class="mt-3">
                    <h4> Dados pessoais </h4>

                    <form action="{{ url_for('add_dadospessoais') }}" method="post">
                        <div class="">
                            <div class="form-floating mb-3">
                                <input type="text" class="form-control" name="nome" placeholder="Nome"
                                       value="{{ dadospessoais.nome if dadospessoais else '' }}">
                                <label> Nome</label>
                            </div>

                            <div class="form-floating mb-3">
                                <input type="text" class="form-control" id="floatingInput" name="titulo"
                                       placeholder="Título Profissional"
                                       value="{{ dadospessoais.titulo if dadospessoais else '' }}">
                                <label for="floatingInput"> Título Profissional</label>
                            </div>

                            <div class="form-floating mb-3">
                                <input type="text" class="form-control" id="floatingInput" name="endereco"
                                       placeholder="Endereço"
                                       value="{{ dadospessoais.endereco if dadospessoais else '' }}">
                                <label for="floatingInput"> Endereço</label>
                            </div>

                            <div class="form-floating mb-3">
                                <input type="text" class="form-control" id="floatingInput" name="site"
                                       placeholder="Site pessoal ou LinkedIn"
                                       value="{{ dadospessoais.site if dadospessoais else '' }}">
                                <label for="floatingInput">Site pessoal</label>
                            </div>

                            <div class="form-floating mb-3">
                                <input type="text" class="form-control" id="floatingInput" name="telefone"
                                       placeholder="Telefone"
                                       value="{{ dadospessoais.telefone if dadospessoais else '' }}">
                                <label for="floatingInput">Telefone </label>
                            </div>

                            <div class="form-floating mb-3">
                                <input type="text" class="form-control" id="floatingInput" name="email"
                                       placeholder="Email" value="{{ dadospessoais.email if dadospessoais else '' }}">
                                <label for="floatingInput"> Email</label>
                            </div>

                            <div class="form-floating mb-3">
                                <textarea class="form-control" style="height: 120px;" id="floatingInput" rows="5"
                                          name="objetivo">{{ dadospessoais.objetivo if dadospessoais else '' }}</textarea>
                                <label for="floatingInput" class="form-label"> Objetivo </label>
                                <button class="btn btn-primary" id="objetivo" type="button" style="position: absolute; bottom: 0; right: 0;"
                                        onclick="chatgpt()">
                                    IA</i>
                                </button>
                            </div>

                        </div>
                        <button class="btn btn-primary mt-3"> Salvar</button>

                    </form>
                </div>
                <!-- Dados pessoais -->

                <!-- Experiência profissional -->
                <div class="mt-2">
                    <h4> Experiência Profissional </h4>

                    {% for exp in experiencia %}
                        <div class="card mt-3">
                            <div class="card-body">
                                <p class="visually-hidden">{{ exp.id }}</p>
                                <h5 class="card-title">{{ exp.cargo }}</h5>
                                <h6 class="card-subtitle mb-2 text-muted">{{ exp.empresa }}</h6>
                                <p class="card-text">{{ exp.data }}</p>
                                <p class="card-text">{{ exp.descricao }}</p>
                                <a onclick="showForm('experiencia'), editarExperiencia('{{ exp.cargo }}', '{{ exp.empresa }}', '{{ exp.data }}', '{{ exp.descricao }}', '{{ exp.id }}')"
                                   class="card-link"> Editar </a>
                                <a href="{{ url_for('delete_experiencia', id = exp.id) }}" class="card-link">Excluir</a>
                            </div>
                        </div>
                    {% endfor %}

                    <form class="mt-3" action="{{ url_for('add_experiencia') }}" method="post" id="experiencia_form" style="display: none;">
                        <hr class="mt-3">
                        <p> Digite as informações da experiência profissional :</p>

                        <input type="hidden" id="exp_id" name="id">

                        <div class="form-floating mb-3">
                            <input type="text" class="form-control" id="exp_cargo" name="cargo" placeholder="Cargo">
                            <label for="floatingInput"> Cargo</label>
                        </div>

                        <div class="form-floating mb-3">
                            <input type="text" class="form-control" id="exp_empresa" name="empresa"
                                   placeholder="Empresa">
                            <label for="floatingInput"> Empresa</label>
                        </div>

                        <div class="form-floating mb-3">
                            <input type="text" class="form-control" id="exp_data" name="data"
                                   placeholder="Data">
                            <label for="floatingInput"> Data </label>
                        </div>

                        <div>
                            <label for="floatingInput" class="form-label mt-4"> Descrição </label>
                            <textarea class="form-control" id="exp_descricao" rows="3" name="descricao"></textarea>
                        </div>

                        <button class="btn btn-primary mt-3"> Salvar</button>
                    </form>

                    <div class="py-3">
                        <button class="btn btn-success" onclick="showForm('experiencia')">Adicionar Experiência</button>
                    </div>
                </div>
                <!-- Experiência profissional -->

                <!-- Formação acadêmica -->
                <div class="mt-2">
                    <h4> Formação Acadêmica </h4>

                    {% for form in formacao %}
                        <div class="card mt-3">
                            <div class="card-body">
                                <p class="visually-hidden">{{ form.id }}</p>
                                <h5 class="card-title mb-2">{{ form.curso }}</h5>
                                <h6 class="card-subtitle mb-2 text-muted">{{ form.instituicao }}</h6>
                                <p class="card-text">{{ form.data }}</p>
                                <p class="card-text">{{ form.descricao }}</p>
                                <a onclick="showForm('formacao'), editarFormacao('{{ form.curso }}', '{{ form.instituicao }}', '{{ form.data }}', '{{ form.descricao }}', '{{ form.id }}')"
                                   class="card-link"> Editar</a>
                                <a href="{{ url_for('delete_formacao', id = form.id) }}" class="card-link">Excluir</a>
                            </div>
                        </div>
                    {% endfor %}

                    <form class="mt-3" action="{{ url_for('add_formacao') }}" method="post" id="formacao_form" style="display: none;">

                        <hr class="mt-3">
                        <p> Digite as informações da formação acadêmica :</p>

                        <input type="hidden" id="for_id" name="id">

                        <div class="form-floating mb-3">
                            <input type="text" class="form-control" id="for_curso" name="curso" placeholder="Curso">
                            <label for="floatingInput"> Curso</label>
                        </div>

                        <div class="form-floating mb-3">
                            <input type="text" class="form-control" id="for_instituicao" name="instituicao"
                                   placeholder="Instituição">
                            <label for="floatingInput"> Instituição</label>
                        </div>

                        <div class="form-floating mb-3">
                            <input type="text" class="form-control" id="for_data" name="data" placeholder="Data">
                            <label for="floatingInput"> Data </label>
                        </div>

                        <div>
                            <label for="floatingInput" class="form-label mt-4"> Descrição </label>
                            <textarea class="form-control" id="for_descricao" rows="3" name="descricao"></textarea>
                        </div>

                        <button class="btn btn-primary mt-3"> Salvar</button>
                    </form>

                    <div class="py-3">
                        <button class="btn btn-success" onclick="showForm('formacao')">Adicionar Formação</button>
                    </div>
                </div>
                <!-- Formação acadêmica -->

                <!-- Habilidades -->
                <div class="mt-2 mb-5">
                    <h4> Habilidades </h4>

                    <div class="d-flex justify-content-start row row-cols-4 py-1 px-1">
                        {% for hab in habilidade %}
                            <div class="py-1 px-1">
                                <div class="col align-items-center card ">
                                    <p class="mb-0">{{ hab.nome }}</p>
                                    <a href="{{ url_for('delete_habilidade', id = hab.id) }}" class="">Excluir</a>
                                    <p class="visually-hidden">{{ hab.id }}</p>
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                    <div class="pb-5">
                        <form class="mt-3" action="{{ url_for('add_habilidade') }}" method="post">
                            <p> Digite uma nova habilidade :</p>

                            <div class="row row-cols-2">
                                <div class="col col-8 form-floating">
                                    <input type="text" class="form-control" id="hab_nome" name="nome" placeholder="Habilidade">
                                    <label for="floatingInput "> Habilidade</label>
                                </div>

                                <div class="col col-4 d-flex align-items-center">
                                    <button class="btn btn-primary "> Adicionar Skill</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <!-- Habilidades -->

            <!-- Lado direito -->
            <div class="col col-6">
                <div class="py-4">
                    <div class="row mt-4">
                        <a href="#" onclick="printCurriculo()"><i class="fa-solid fa-print"></i> Imprimir</a>

                    </div>
                </div>
                <iframe id="frame" class="shadow overflow-y-auto" src="/curriculo" width="100%" height="80%"></iframe>
            </div>
            <!-- Lado direito -->
        </div>
        </section>
    {% endif %}
</div>
<!-- Conteúdo -->

<!-- Modal Login -->
<div class="modal" id="loginModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Faça o login</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true"></span>
                </button>
            </div>
            <div class="modal-body">
                <form action="{{ url_for('login') }}" method="post">
                    <!-- Email input -->
                    <div class="form-outline mb-4">
                        <label class="form-label" for="email">Endereço de Email</label>
                        <input type="email" id="email" name="email" class="form-control"/>
                    </div>

                    <!-- Password input -->
                    <div class="form-outline mb-4">
                        <label class="form-label" for="senha">Senha</label>
                        <input type="password" id="senha" name="senha" class="form-control"/>
                    </div>

                    <!-- Submit button -->
                    <button type="submit" class="btn btn-primary btn-block">Login</button>
                </form>
            </div>
        </div>
    </div>
</div>
<!-- Modal Login -->

<!-- Modal Cadastro -->
<div class="modal" id="registerModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Registrar um novo usuário</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true"></span>
                </button>
            </div>
            <div class="modal-body">
                <form action="{{ url_for('register') }}" method="post">
                    <!-- Email input -->
                    <div class="form-outline mb-4">
                        <label class="form-label" for="email">Endereço de Email</label>
                        <input type="email" id="email" name="email" class="form-control"/>
                    </div>

                    <!-- Password input -->
                    <div class="form-outline mb-4">
                        <label class="form-label" for="senha">Senha</label>
                        <input type="password" id="senha" name="senha" class="form-control"/>
                    </div>

                    <!-- Submit button -->
                    <button type="submit" class="btn btn-primary btn-block">Registrar</button>
                </form>
            </div>
        </div>
    </div>
</div>
<!-- Modal Cadastro -->

<!-- Mensagem de alerta -->
{% if mensagem %}
    <div id="autoCloseAlert" class="alert alert-dismissible alert-{{ tipo }} position-fixed bottom-0 end-0 mb-3 me-3"
         style="z-index: 9999;">
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        {{ mensagem }}
    </div>
{% endif %}
<!-- Mensagem de alerta -->

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<!-- Javascript -->
<script>
    // Auto close alert
    window.onload = function () {
        setTimeout(function () {
            const alertElement = document.getElementById('autoCloseAlert');
            const bsAlert = new bootstrap.Alert(alertElement);
            bsAlert.close();
        }, 5000); // close the alert after 5000 milliseconds (5 seconds)
    };

    // Edita a experiência
    function editarExperiencia(cargo, empresa, data, descricao, id) {
        document.getElementById('exp_cargo').value = cargo;
        document.getElementById('exp_empresa').value = empresa;
        document.getElementById('exp_data').value = data;
        document.getElementById('exp_descricao').value = descricao;
        document.getElementById('exp_id').value = id;
    }

    // Edita a formação
    function editarFormacao(curso, instituicao, data, descricao, id) {
        document.getElementById('for_curso').value = curso;
        document.getElementById('for_instituicao').value = instituicao;
        document.getElementById('for_data').value = data;
        document.getElementById('for_descricao').value = descricao;
        document.getElementById('for_id').value = id;
    }

    // Mostra o formulários
    function showForm(id) {
        if (id == 'experiencia') {
            document.getElementById('experiencia_form').style.display = 'block';
        } else if (id == 'formacao') {
            document.getElementById('formacao_form').style.display = 'block';
        }
    }

    // Imprime o currículo
    function printCurriculo() {
        var iframe = document.querySelector('iframe');
        iframe.contentWindow.print();
    }

</script>
</body>
</html>